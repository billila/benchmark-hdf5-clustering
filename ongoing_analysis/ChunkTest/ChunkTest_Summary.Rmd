---
title: "chunksize"
author: "Ruoxi Liu"
date: "6/18/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,fig.width = 12, fig.height = 10)
```

```{r}
library(tidyr)
library(ggplot2)
library(gridExtra)
library(dplyr)
library(grid)
library(here)
```

```{r}
files <- list.files(path= here("ongoing_analysis","ChunkTest"), pattern="*.csv", full.names=TRUE, recursive=FALSE)

final_table <- NULL

for (i in (1:length(files))){
  temp_table <- read.csv(file = files[i], header=TRUE, sep=",")[,1:5]
  final_table <- rbind(final_table, temp_table)
}
```

```{r}
final_table %>% 
  dplyr::group_by(dimension, observations, batch_size) %>% 
  dplyr::summarize(mean = mean(time), 
                   sd = sd(time)) %>% 
  ggplot(aes(x = observations, y = mean, color = dimension)) +
          geom_line()+
          geom_point()+
          geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
                position=position_dodge(0.05))+
        labs(title = "Observation vs. time w/ increading Batch Size") + 
  facet_wrap(~batch_size)
```

```{r}
final_table %>% 
  dplyr::filter(dimension != "one") %>%
  dplyr::group_by(dimension, observations, batch_size) %>% 
  dplyr::summarize(mean = mean(time), 
                   sd = sd(time)) %>% 
  ggplot(aes(x = observations, y = mean, color = dimension)) +
          geom_line()+
          geom_point()+
          geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
                position=position_dodge(0.05))+
        labs(title = "Observation vs. time w/ increading Batch Size") + 
  facet_wrap(~batch_size)
```

